<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">-->

    <title>WoOx Travel Bootstrap 5 Theme</title>

    <!-- Bootstrap core CSS -->
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="/assets/css/fontawesome.css">
    <link rel="stylesheet" href="/assets/css/templatemo-woox-travel.css">
    <link rel="stylesheet" href="/assets/css/owl.css">
    <link rel="stylesheet" href="/assets/css/animate.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <!--

    TemplateMo 580 Woox Travel

    https://templatemo.com/tm-580-woox-travel

    -->

</head>

<body>

<!-- ***** Preloader Start ***** -->
<div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
        <span class="dot"></span>
        <div class="dots">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
</div>
<!-- ***** Preloader End ***** -->

<!-- ***** Header Area Start ***** -->
<header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <!-- ***** Logo Start ***** -->
                    <a href="/index" class="logo">
                        <img src="/assets/images/logo.png" alt="">
                    </a>
                    <!-- ***** Logo End ***** -->
                    <!-- ***** Menu Start ***** -->
                    <ul class="nav">
                        <li>
                            <form action="/index"><input type="submit" value="主页"></form>
                        </li>
                        <li th:if="${cur.getRole() == 1}">
                            <form action="/orders"><input type="submit" value="审核"></form>
                        </li>
                        <li th:if="${cur.getRole() == 1}">
                            <form action="/publish"><input type="submit" value="发布"></form>
                        </li>
                        <li>
                            <form action="/myInfo"><input type="submit" value="我的"></form>
                        </li>
                        <!--                        <li><a href="reservation.html">Book Yours</a></li>-->
                    </ul>
                    <a class='menu-trigger'>
                        <span>Menu</span>
                    </a>
                    <!-- ***** Menu End ***** -->
                </nav>
            </div>
        </div>
    </div>
</header>
<!-- ***** Header Area End ***** -->

<!-- ***** Main Banner Area Start ***** -->
<section id="section-1">
    <div class="content-slider">
        <input type="radio" id="banner1" class="sec-1-input" name="banner" checked>
        <input type="radio" id="banner2" class="sec-1-input" name="banner">
        <input type="radio" id="banner3" class="sec-1-input" name="banner">
        <input type="radio" id="banner4" class="sec-1-input" name="banner">
        <div class="slider" id="sliderDisplay">
        </div>
        <nav>
            <div class="controls">
                <label for="banner1"><span class="progressbar"><span class="progressbar-fill"></span></span><span
                        class="text">1</span></label>
                <label for="banner2"><span class="progressbar"><span class="progressbar-fill"></span></span><span
                        class="text">2</span></label>
                <label for="banner3"><span class="progressbar"><span class="progressbar-fill"></span></span><span
                        class="text">3</span></label>
                <label for="banner4"><span class="progressbar"><span class="progressbar-fill"></span></span><span
                        class="text">4</span></label>
            </div>
        </nav>
    </div>
</section>
<!-- ***** Main Banner Area End ***** -->

<div class="visit-country">
    <div class="container">
        <div class="row">
            <div class="col-lg-5">
                <div class="section-heading">
                    <h2>行程</h2>
                    <p>以下是一些当天可以发车的行程信息</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8">
                <div class="items">
                    <div class="row" id="roadProcess">
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="side-bar-map">
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="map">
                                <!--                  <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d12469.776493332698!2d-80.14036379941481!3d25.907788681148624!2m3!1f357.26927939317244!2f20.870722720054623!3f0!3m2!1i1024!2i768!4f35!3m3!1m2!1s0x88d9add4b4ac788f%3A0xe77469d09480fcdb!2sSunny%20Isles%20Beach!5e1!3m2!1sen!2sth!4v1642869952544!5m2!1sen!2sth" width="100%" height="550px" frameborder="0" style="border:0; border-radius: 23px; " allowfullscreen=""></iframe>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <p>Copyright © 2036 <a href="#">WoOx Travel</a> Company. All rights reserved.
                    <br>Design: <a href="https://templatemo.com" target="_blank"
                                   title="free CSS templates">TemplateMo</a></p>
            </div>
        </div>
    </div>
</footer>


<!-- Scripts -->
<!-- Bootstrap core JavaScript -->
<script src="/vendor/jquery/jquery.min.js"></script>
<script src="/vendor/bootstrap/js/bootstrap.min.js"></script>

<script src="/assets/js/isotope.min.js"></script>
<script src="/assets/js/owl-carousel.js"></script>
<script src="/assets/js/wow.js"></script>
<script src="/assets/js/tabs.js"></script>
<script src="/assets/js/popup.js"></script>
<script src="/assets/js/custom.js"></script>

<script>
    function bannerSwitcher() {
        next = $('.sec-1-input').filter(':checked').next('.sec-1-input');
        if (next.length) next.prop('checked', true);
        else $('.sec-1-input').first().prop('checked', true);
    }

    var bannerTimer = setInterval(bannerSwitcher, 5000);

    $('nav .controls label').click(function () {
        clearInterval(bannerTimer);
        bannerTimer = setInterval(bannerSwitcher, 5000)
    });

    var names = ["李师傅", "王师傅", "杨师傅", "谢师傅", "李师傅", "王师傅", "谢师傅", "李师傅", "王师傅", "谢师傅"]
    var carNo = ["京A 11234J", "渝B F445G9", "川R IF765", "川G FG653", "陕A 1701B77", "陕B 10B707", "川A 17B797"]
    var infomation = ["今天下午到韦曲南，电话联系18781195359", "今天下午到老校区，电话联系18781195359", "今天下午到六号线，电话联系18781195359", "今天下午到韦曲南，电话联系18781195359", "今天下午到韦曲南，电话联系18781195359", "今天下午到老校区，电话联系18781195359", "今天下午到六号线，电话联系18781195359"]
    var leftPerson = [1, 4, 3, 3, 2, 3, 4]
    var destination = ["二号线", "六号线", "老校区", "二号线", "二号线", "六号线", "老校区"]
    var price = [20, 30, 50, 20, 20, 30, 50]
    var dateOfCar = ["2023 年 1 月 1 日", "2023 年 1 月 5 日", "2023 年 12 月 11 日", "2023 年 2 月 10 日", "2023 年 1 月 1 日", "2023 年 1 月 5 日", "2023 年 12 月 11 日"]
    var beginOfArray = 4
    let pageNoOfNow = 2

    var dataList = []


    $(function () {
        getData()
    })

    function bindTapReserve(index) {
        document.location.href = encodeURI("/orders/generate?name=" + dataList[index].ownerName + "&carNo=" + dataList[index].carNum + "&price=" + dataList[index].price + "&date=" + dataList[index].days + "&destination=" + dataList[index].ending + "&id=" + dataList[index].infoId + "&ownerId=" + dataList[index].ownerId);
    }

    function getData() {
        $.ajax({
            url: '/owner/allInfo',
            type: 'get',
            success: function (res) {
                dataList = res.data
                console.log(dataList)
                initProcess()
                initBanner()
            },
            fail: function () {
                alert('数据加载失败')
            }
        })
    }

    function initBanner() {
        for (var i = 0; i < 4; i++) {
            var div = document.createElement("div")
            div.innerHTML = `
         <div class="banner-inner-wrapper header-text">
            <div class="main-caption">
            <h2>${dataList[i].remark}</h2>
             <h1>${dataList[i].ownerName}</h1>
             <div class="border-button"><a>${dataList[i].ending}</a></div>
            </div>
            <div class="container">
              <div class="row">
                <div class="col-lg-12">
                  <div class="more-info">
                    <div class="row">
                      <div class="col-lg-3 col-sm-6 col-6">
                        <i class="fa fa-user"></i>
                        <h4><span>剩余人数:</span><br>${dataList[i].remain}人</h4>
                      </div>
                      <div class="col-lg-3 col-sm-6 col-6">
                        <i class="fa fa-globe"></i>
                        <h4><span>日期:</span><br>${dataList[i].days}</h4>
                      </div>
                      <div class="col-lg-3 col-sm-6 col-6">
                        <i class="fa fa-home"></i>
                        <h4><span>价格:</span><br>${dataList[i].price}元</h4>
                      </div>
                      <div class="col-lg-3 col-sm-6 col-6">
                        <div class="main-button" onclick="bindTapReserve(${i})">
                          <a>预约</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `
            div.id = "top-banner-" + (i + 1)
            div.classList.add("banner")
            document.querySelector("#sliderDisplay").appendChild(div)
        }
    }


    //初始化行程
    function initProcess() {
        let end = beginOfArray + 3 * (pageNoOfNow - 1) > dataList.length ? dataList.length : beginOfArray + 3 * (pageNoOfNow - 1)
        console.log(end)
        for (var i = beginOfArray + (pageNoOfNow - 2) * 3; i < end; i++) {
            var div = document.createElement("div");
            div.classList.add("col-lg-12")
            div.innerHTML = `

       <div class="item">
        <div class="row">
          <div class="col-lg-4 col-sm-5">
            <div class="image">
              <img src="assets/images/country-0${i + 1 - beginOfArray - (pageNoOfNow - 2) * 3}.jpg" alt="">
            </div>
          </div>
          <div class="col-lg-8 col-sm-7">
            <div class="right-content">
              <h4>${dataList[i].carNum}</h4>
              <span>${dataList[i].ownerName}</span>
              <div class="main-button" onclick="bindTapReserve(${i})" style="color: white">
                <a>预约</a>
              </div>
              <p> ${dataList[i].remark}</p>
              <ul class="info">
                <li><i class="fa fa-user"></i> ${dataList[i].remain}人</li>
                <li><i class="fa fa-globe"></i> ${dataList[i].ending}</li>
                <li><i class="fa fa-home"></i> ${dataList[i].price}元</li>
              </ul>
              <div class="text-button">
                <a > ${dataList[i].days}</a>
              </div>
            </div>
          </div>
        </div>
      </div>

        `
            document.querySelector("#roadProcess").appendChild(div)
        }

        var div1 = document.createElement("div")
        div1.classList.add("col-lg-12")
        div1.innerHTML = `
                <ul class="page-numbers">
                  <li onclick="frontPage()"><a href="#"><i class="fa fa-arrow-left"></i></a></li>
<!--                  <li><a href="#">1</a></li>-->
                  <li class="active"><a href="#">${pageNoOfNow}</a></li>
<!--                  <li><a href="#">3</a></li>-->
                  <li onclick="backPage()"><a href="#"><i class="fa fa-arrow-right"></i></a></li>
                </ul>
      `
        document.querySelector("#roadProcess").appendChild(div1)
    }

    function frontPage() {
        if (pageNoOfNow === 2) {
            return
        }
        pageNoOfNow -= 1
        removeAllEle()
        initProcess()
    }

    function backPage() {
        if (beginOfArray + 3 * (pageNoOfNow - 1) > dataList.length) {
            return
        }
        pageNoOfNow += 1
        removeAllEle()
        initProcess()
    }

    function removeAllEle() {
        let orderList = document.querySelector("#roadProcess")
        var child = orderList.lastElementChild
        while (child) {
            orderList.removeChild(child)
            child = orderList.lastElementChild
        }
    }

</script>

</body>

</html>
